# æ¨¡å—è¯¦ç»†è§„æ ¼ç›®å½•

## æ•°æ®æ ¼å¼çº¦å®š

æ‰€æœ‰æ¨¡å—æ¥æ”¶çš„æ•°æ®ä½¿ç”¨ç»Ÿä¸€çš„TypeScriptæ¥å£å®šä¹‰ã€‚

```typescript
// åŸºç¡€ç±»å‹
interface BaseModule {
  id: string;
  timestamp?: string;
}

// è§’è‰²ç±»å‹
interface Character {
  id: string;
  name: string;
  avatar?: string;
  color?: string; // ä¸»é¢˜è‰²
}
```

---

## æ ¸å¿ƒæ¨¡å—

### scene-header (æ—¶é—´åœ°ç‚¹æ¨¡å—)

```typescript
interface SceneHeader extends BaseModule {
  type: 'scene-header';
  time: string;          // "æ·±å¤œ 23:47" æˆ– "ç¬¬ä¸‰å¤© é»„æ˜"
  location: string;      // "å’–å•¡é¦†äºŒæ¥¼"
  weather?: string;      // "å°é›¨"
  atmosphere?: string;   // "å®‰é™è€Œç•¥æ˜¾å‹æŠ‘"
}
```

**æ¸²æŸ“ç¤ºä¾‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ å’–å•¡é¦†äºŒæ¥¼  Â·  æ·±å¤œ 23:47   â”‚
â”‚     ğŸŒ§ï¸ å°é›¨ Â· å®‰é™è€Œç•¥æ˜¾å‹æŠ‘    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### character-status (äººç‰©çŠ¶æ€æ¨¡å—)

```typescript
interface CharacterStatus extends BaseModule {
  type: 'character-status';
  character: Character;
  appearance: string;     // è¡£ç€å¤–è§‚
  action: string;         // å½“å‰åŠ¨ä½œ
  expression?: string;    // è¡¨æƒ…
  innerThought?: string;  // å†…å¿ƒOS
  mood?: number;          // å¿ƒæƒ…å€¼ 0-100
  customFields?: Array<{  // ç”¨æˆ·è‡ªå®šä¹‰å­—æ®µ
    label: string;
    value: string;
    icon?: string;
  }>;
}
```

**æ¸²æŸ“ç¤ºä¾‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [å¤´åƒ]  è‹æ™š                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ‘” è¡£ç€ï¼šç™½è‰²è¡¬è¡«ï¼Œé»‘è‰²é•¿è£¤         â”‚
â”‚  ğŸ¬ åŠ¨ä½œï¼šå€šé åœ¨çª—è¾¹ï¼Œæœ›å‘çª—å¤–       â”‚
â”‚  ğŸ˜Œ è¡¨æƒ…ï¼šè‹¥æœ‰æ‰€æ€                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  ğŸ’­ (ä»–åœ¨æƒ³ä»€ä¹ˆå‘¢...ä»Šå¤©çš„å¤©æ°”...)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### memory-log (è®°å¿†æ¨¡å—)

```typescript
interface MemoryLog extends BaseModule {
  type: 'memory-log';
  entries: MemoryEntry[];
  compressionThreshold: number; // é»˜è®¤10
}

interface MemoryEntry {
  index: string;        // "<01>" æ ¼å¼
  content: string;
  timestamp?: string;
  importance: 'normal' | 'important' | 'critical';
  compressed?: boolean; // æ˜¯å¦ä¸ºå‹ç¼©åçš„å¤§è®°å¿†
}
```

**å‹ç¼©è§„åˆ™**:
- æ¯10æ¡æ™®é€šè®°å¿†å‹ç¼©ä¸º1æ¡å¤§è®°å¿†
- å¤§è®°å¿†ä½¿ç”¨ `<Î£01-10>` æ ¼å¼æ ‡è®°
- é‡è¦/å…³é”®è®°å¿†ä¸å‚ä¸å‹ç¼©

**æ¸²æŸ“ç¤ºä¾‹**:
```
â”Œâ”€ è®°å¿†æ¡£æ¡ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  <Î£01-10> ä¸è‹æ™šåˆæ¬¡ç›¸é‡ï¼Œåœ¨å’–å•¡é¦†... â”‚
â”‚  <11> å¥¹è¯´å¥¹å–œæ¬¢ä¸‹é›¨å¤©               â”‚
â”‚  <12> ä¸€èµ·å»äº†ä¹¦åº—                   â”‚
â”‚  <13> â­ å¥¹ç¬¬ä¸€æ¬¡å«äº†æˆ‘çš„åå­—        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¯¹è¯ç±»æ¨¡å—

### group-chat (ç¾¤èŠæ¨¡å—)

```typescript
interface GroupChat extends BaseModule {
  type: 'group-chat';
  groupName: string;
  groupAvatar?: string;
  messages: GroupMessage[];
}

interface GroupMessage {
  sender: Character;
  content: string;
  type: 'text' | 'image' | 'sticker' | 'system';
  replyTo?: string;      // å›å¤çš„æ¶ˆæ¯ID
  reactions?: string[];  // è¡¨æƒ…å›åº”
}
```

**æ¸²æŸ“ç¤ºä¾‹** (å¾®ä¿¡é£æ ¼):
```
â”Œâ”€ æ·±å¤œé£Ÿå ‚ (5) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                       â”‚
â”‚  [æ—æ¸…] æœ‰äººè¿˜é†’ç€å—                  â”‚
â”‚                                       â”‚
â”‚              ä»Šå¤©çš„ä¼šè®®å¤ªç´¯äº† [è‹æ™š]  â”‚
â”‚                                       â”‚
â”‚  [é™ˆç„¶] @è‹æ™š è¾›è‹¦äº†                  â”‚
â”‚         ç»™ä½ ç‚¹äº†æ¯å’–å•¡                â”‚
â”‚                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€ ç³»ç»Ÿæ¶ˆæ¯ â”€â”€â”€â”€â”€â”€              â”‚
â”‚  è‹æ™š æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯                  â”‚
â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### private-message (ç§ä¿¡æ¨¡å—)

```typescript
interface PrivateMessage extends BaseModule {
  type: 'private-message';
  contact: Character;
  messages: PMMessage[];
  unreadCount?: number;
}

interface PMMessage {
  isUser: boolean;       // æ˜¯å¦ä¸ºç”¨æˆ·å‘é€
  content: string;
  time: string;
  status?: 'sent' | 'delivered' | 'read';
}
```

---

## å™äº‹ç±»æ¨¡å—

### narrator (æ—ç™½æ¨¡å—)

```typescript
interface Narrator extends BaseModule {
  type: 'narrator';
  style: 'omniscient' | 'limited' | 'objective';
  content: string;
  emphasis?: 'normal' | 'dramatic' | 'whisper';
}
```

**æ¸²æŸ“ç¤ºä¾‹**:
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   é›¨æ»´æ•²æ‰“ç€ç»ç’ƒçª—ï¼Œåƒæ˜¯æŸç§é¢„å…†ã€‚
   åœ¨è¿™ä¸ªåŸå¸‚çš„æŸä¸ªè§’è½ï¼Œä¸¤ä¸ªé™Œç”Ÿäºº
   çš„å‘½è¿å³å°†äº§ç”Ÿäº¤é›†ã€‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

### public-reaction (å…¬ä¼—è®¨è®ºæ¨¡å—)

```typescript
interface PublicReaction extends BaseModule {
  type: 'public-reaction';
  eventTitle?: string;
  reactions: Reaction[];
  format: 'comments' | 'tweets' | 'forum';
}

interface Reaction {
  author: string;        // å¯ä»¥æ˜¯åŒ¿å "è·¯äººA"
  avatar?: string;
  content: string;
  likes?: number;
  sentiment: 'positive' | 'negative' | 'neutral';
}
```

**æ¸²æŸ“ç¤ºä¾‹** (è¯„è®ºåŒºé£æ ¼):
```
â”Œâ”€ å…³äºã€Œè‹æ™šçš„æ¼”è®²ã€å¤§å®¶æ€ä¹ˆçœ‹ â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                        â”‚
â”‚  è·¯äººç”² ğŸ‘ 128                         â”‚
â”‚  è¯´å¾—å¤ªå¥½äº†ï¼ç»ˆäºæœ‰äººæ•¢è¯´çœŸè¯          â”‚
â”‚                                        â”‚
â”‚  åŒ¿åç”¨æˆ·                              â”‚
â”‚  æ„Ÿè§‰æœ‰ç‚¹å¤ªæ¿€è¿›äº†...                   â”‚
â”‚                                        â”‚
â”‚  å°æ˜åŒå­¦ ğŸ‘ 56                        â”‚
â”‚  åœ¨ç°åœºï¼Œæ°›å›´çœŸçš„å¾ˆéœ‡æ’¼                â”‚
â”‚                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### atmosphere (æ°”æ°›æ¸²æŸ“æ¨¡å—)

```typescript
interface Atmosphere extends BaseModule {
  type: 'atmosphere';
  environment: string;    // ç¯å¢ƒæè¿°
  sounds?: string[];      // éŸ³æ•ˆæç¤º
  bgm?: string;           // èƒŒæ™¯éŸ³ä¹å»ºè®®
  visualEffects?: string; // è§†è§‰æ•ˆæœæç¤º
  intensity: 1 | 2 | 3;   // æ¸²æŸ“å¼ºåº¦
}
```

---

## æ¸¸æˆåŒ–æ¨¡å—

### affection-bar (å¥½æ„Ÿåº¦æ¨¡å—)

```typescript
interface AffectionBar extends BaseModule {
  type: 'affection-bar';
  character: Character;
  level: number;         // å½“å‰ç­‰çº§
  currentValue: number;  // å½“å‰å€¼
  maxValue: number;      // æ»¡çº§å€¼
  relationship: string;  // "é™Œç”Ÿäºº" | "æœ‹å‹" | "æŒšå‹" | "æ‹äºº"
  recentChange?: number; // æœ€è¿‘å˜åŒ– +5 / -3
}
```

**æ¸²æŸ“ç¤ºä¾‹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’• è‹æ™š Â· å¥½æ„Ÿåº¦                    â”‚
â”‚  â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘ Lv.7 (68/100)       â”‚
â”‚  å…³ç³»ï¼šæŒšå‹                          â”‚
â”‚  ğŸ“ˆ +5 (å› ä¸ºä¸€èµ·çœ‹äº†ç”µå½±)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### choice-branch (é€‰é¡¹åˆ†æ”¯æ¨¡å—)

```typescript
interface ChoiceBranch extends BaseModule {
  type: 'choice-branch';
  prompt?: string;        // æç¤ºæ–‡æœ¬
  choices: Choice[];
  timer?: number;         // é™æ—¶é€‰æ‹©ï¼ˆç§’ï¼‰
  style: 'buttons' | 'cards' | 'floating';
}

interface Choice {
  id: string;
  text: string;
  hint?: string;          // é€‰é¡¹æç¤º
  consequence?: string;   // åæœé¢„è§ˆ
  locked?: boolean;       // æ˜¯å¦é”å®š
  lockReason?: string;
}
```

**æ¸²æŸ“ç¤ºä¾‹**:
```
â”Œâ”€ ä½ è¦æ€ä¹ˆå›åº”ï¼Ÿ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  A. "æˆ‘ä¸€ç›´éƒ½åœ¨è¿™é‡Œ"            â”‚ â”‚
â”‚  â”‚     ğŸ’• å¯èƒ½å¢åŠ å¥½æ„Ÿåº¦            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  B. "ä½ æƒ³å¤šäº†"                  â”‚ â”‚
â”‚  â”‚     âš ï¸ å¯èƒ½å¼•èµ·è¯¯ä¼š              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ”’ C. æ²‰é»˜                     â”‚ â”‚
â”‚  â”‚     éœ€è¦ã€Œå†·é™ã€æŠ€èƒ½ Lv.3       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                       â”‚
â”‚           â±ï¸ å‰©ä½™ 15 ç§’               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### item-popup (ç‰©å“è·å–æ¨¡å—)

```typescript
interface ItemPopup extends BaseModule {
  type: 'item-popup';
  item: {
    name: string;
    icon?: string;
    rarity: 'common' | 'rare' | 'epic' | 'legendary';
    description: string;
    effect?: string;
  };
  source?: string;        // è·å¾—æ¥æº
  animation: 'slide' | 'bounce' | 'glow';
}
```

---

## ä¿¡æ¯ç±»æ¨¡å—

### character-card (è§’è‰²æ¡£æ¡ˆå¡)

```typescript
interface CharacterCard extends BaseModule {
  type: 'character-card';
  character: Character;
  basicInfo: {
    age?: string;
    birthday?: string;
    occupation?: string;
    mbti?: string;
  };
  stats?: Array<{
    label: string;
    value: number;
    maxValue: number;
  }>;
  tags?: string[];
  quote?: string;
}
```

---

### lore-tooltip (ä¸–ç•Œè§‚è¯æ¡)

```typescript
interface LoreTooltip extends BaseModule {
  type: 'lore-tooltip';
  term: string;           // æœ¯è¯­å
  category: string;       // "äººç‰©" | "åœ°ç‚¹" | "ç»„ç»‡" | "æ¦‚å¿µ"
  definition: string;     // ç®€çŸ­å®šä¹‰
  fullDescription?: string; // å®Œæ•´æè¿°ï¼ˆå±•å¼€åï¼‰
  relatedTerms?: string[];
  firstMention?: string;  // é¦–æ¬¡å‡ºç°ç« èŠ‚
}
```

---

## æ¨¡å—ç»„åˆä½¿ç”¨

### æ¨èç»„åˆ

**æ²‰æµ¸å™äº‹åœºæ™¯**:
```
scene-header + narrator + character-status + chat-bubble
```

**ç¤¾äº¤äº’åŠ¨åœºæ™¯**:
```
group-chat + public-reaction + notification + social-feed
```

**æ¸¸æˆåŒ–åœºæ™¯**:
```
affection-bar + choice-branch + item-popup + quest-tracker
```

### å¸ƒå±€å»ºè®®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           scene-header (é¡¶éƒ¨)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    â”‚  character-status  â”‚
â”‚    ä¸»å¯¹è¯åŒºåŸŸ      â”‚  affection-bar     â”‚
â”‚                    â”‚  memory-log        â”‚
â”‚                    â”‚     (ä¾§è¾¹æ )       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      choice-branch (åº•éƒ¨æµ®åŠ¨)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
